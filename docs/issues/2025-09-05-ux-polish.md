## UX polish: app shell, visual hierarchy, and engaging interactions

### Summary
Improve visual clarity, consistency, and engagement across Home, Puzzle, and Report. Introduce a lightweight component system (Card, Button, Badge, Skeleton) and a sticky app header with navigation. Emphasize feedback, clear primary actions, and accessible interactions.

### Goals
- Establish a cohesive app shell and navigation.
- Improve readability with consistent spacing/typography and sectioned cards.
- Make primary actions obvious (Analyze, Play Next, Review).
- Provide clear feedback (loading, empty, error) and micro-interactions.
- Ensure accessibility and dark/light theme consistency.

### Scope
- Pages: `/` (Home), `/puzzle`, `/report/latest` (plus `/report/[id]` redirect behavior).
- Components: Header, Card, Button, Badge, Skeleton, EmptyState, Toast.
- Styles: Build on existing Tailwind v4 and CSS variables in `globals.css`.

### Proposed changes

1) App shell & navigation
- Add `Header` with links to Home, Puzzle, Reports, and keep `ThemeToggle`.
- Sticky on desktop; collapsible on mobile.

2) Typography, spacing, and layout
- Standardize containers (`max-w-5xl/6xl`, `p-6`), headings (`text-2xl`/`text-lg`), and section spacing.
- Group related controls/data into `Card` components with surface background and subtle border.

3) Home (Play/Analyze)
- Left: board + vertical eval bar remains; add compact toolbar for Flip/Undo/Forfeit under board.
- Right: three cards:
  - Analysis (Best move, Score, PV)
  - Game controls (mode, depth, ELO)
  - PGN workflow (paste, load, analyze, save)

4) Puzzle
- Top filter bar: difficulty chips, Mate-only toggle, motif input.
- Board section: hint highlight pulse; success confirmation; primary "Next puzzle" button.
- Progress line: X/Y, motif badges, source/rating text.

5) Report
- Two-column: left board + eval bar; right eval graph with click-to-scrub.
- "Key moments" list sorted by severity; click jumps to ply.
- Annotated moves in a scrollable card; phase chips (opening/middlegame/endgame).

6) Components (lightweight)
- Card: surface bg, border, optional header.
- Button: primary/secondary/surface variants; accessible focus rings.
- Badge/Tag: severity colors aligned to grading (Best/Good/Excellent/Inaccuracy/Mistake/Blunder).
- Skeleton: for board/graph/list placeholders.
- EmptyState: concise guidance when data is absent.
- Toast: compact error notifications.

7) Visual polish
- Use existing CSS variables for surface/on-surface/muted; ensure contrast in dark mode.
- Subtle transitions on eval bar, hover states on buttons/badges.
- Metadata: meaningful title/description; ensure favicon.

8) Accessibility
- Keyboard navigability; visible focus outlines; ARIA labels for interactive SVG (eval graph).
- Avoid color-only cues; pair with icons/text (e.g., ??, ?, ?!, !, !! symbols).

9) Performance
- Keep dependencies minimal (no heavy UI libs). Debounce or cancel rapid graph scrubs.

### Acceptance criteria
- Header visible on all pages with working nav and theme toggle.
- Home, Puzzle, Report pages use Card-based sections with consistent spacing.
- Primary action on each page is visually prominent.
- Loading/empty/error states present and accessible.
- Dark and light themes render with proper contrast and consistent surfaces.
- No ESLint errors introduced; pages remain functional.

### Implementation tasks
- Create `components/Header.tsx` with nav + `ThemeToggle`.
- Add `components/ui/{Card,Button,Badge,Skeleton,EmptyState,Toast}.tsx`.
- Refactor `src/app/page.tsx`, `src/app/puzzle/page.tsx`, `src/app/report/latest/page.tsx` to use new components and structure.
- Update metadata in `src/app/layout.tsx` (title/description).
- Add minimal CSS tokens if needed (reuse existing variables in `globals.css`).

### Out of scope
- Major feature changes, engine/puzzle logic, or database schema changes.

### Risks/notes
- Ensure interactive performance on lower-end devices (avoid heavy shadows/transitions).
- Verify accessible color contrast for badges on both themes.

### References
- Endpoints leveraged: `/api/analyze`, `/api/report/*`, `/api/puzzles/*`, `/api/analyses`.
- Current styles and tokens: `src/app/globals.css`.

